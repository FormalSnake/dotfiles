"use strict";(("undefined"!=typeof self?self:global).webpackChunkopen=("undefined"!=typeof self?self:global).webpackChunkopen||[]).push([[2342],{78344:(e,a,i)=>{i.d(a,{g:()=>s});var n=i(97018),l=i(48603),t=i(11527);const s=({children:e})=>(0,t.jsx)(n.x,{variant:"bodySmall",className:l.Z.pretitle,children:e})},81542:(e,a,i)=>{i.d(a,{x:()=>m});var n=i(50959),l=i(77020),t=i(10732),s=i(19554),r=i(74893),o=i(84161),c=i(94142),d=i(11527);const m=({children:e,action:a,uri:i})=>{const m=(0,t.g)(),u=(0,r.j)();let g;const h=()=>{const e={triggerId:c.K,triggerAction:{type:a}};o.y.set((a=>({...a,...e}))),u.storeAction(s.wH,{operation:l.pT.ADD,uris:[i]})};try{g=n.Children.only(e)}catch(a){return(0,d.jsx)(d.Fragment,{children:e})}return m?n.cloneElement(g,{onClick:h}):(0,d.jsx)(d.Fragment,{children:e})}},62374:(e,a,i)=>{i.r(a),i.d(a,{default:()=>Je});i(38910);var n=i(50959),l=i(82187),t=i.n(l),s=i(75390),r=i(35869),o=i(28150),c=i(97018),d=i(29693),m=i(97098),u=i(12737),g=i(94523),h=i(10992),b=i(57144),k=i(90150),p=i(39189),x=i(34790),v=i(44930),y=i(52759),j=i(30760),f=i(88724),N=i(27642);const S={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"queryAlbumMerch"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"uri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"albumUnion"},arguments:[{kind:"Argument",name:{kind:"Name",value:"uri"},value:{kind:"Variable",name:{kind:"Name",value:"uri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Album"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"merch"},arguments:[{kind:"Argument",name:{kind:"Name",value:"offset"},value:{kind:"IntValue",value:"0"}},{kind:"Argument",name:{kind:"Name",value:"limit"},value:{kind:"IntValue",value:"20"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"totalCount"}},{kind:"Field",name:{kind:"Name",value:"items"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"albumMerchItem"}}]}}]}}]}}]}}]}},{kind:"FragmentDefinition",name:{kind:"Name",value:"albumMerchItem"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Merch"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"image"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"price"}},{kind:"Field",name:{kind:"Name",value:"uri"}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]};var I=i(48451);const w="iEG0moJ3mt1_j9Lho7MA";var A=i(11527);const C=({albumName:e,albumURI:a})=>{const{data:i}=(n={uri:a},l={gcTime:5*N.y},(0,N.a)(S,n,l));var n,l;const t=i?.albumUnion&&"merch"in i.albumUnion?i?.albumUnion?.merch?.items:[];return t&&t?.length>0?(0,A.jsx)("div",{className:"contentSpacing",children:(0,A.jsx)("div",{className:w,children:(0,A.jsx)(I.s,{id:e,uri:a,merchItems:t,merchVariant:"Album page merch items"})})}):null};var L=i(71707),U=i(79519),F=i(90818),P=i(69918),M=i(2213),T=i(67415),R=i(79287),E=i(22516),B=i(81085),V=i(92718),O=i(31695),D=i(11665),z=i(17207),_=i(44250),q=i(82869),Q=i(9705),Y=i(85509),Z=i(93709),H=i(66562),W=i(81542),K=i(71932),X=i(48439),$=i(73745),J=i(86343),G=i(74181),ee=i(19686),ae=i(3532);const ie="album-albumPage-sectionWrapper",ne="zddjxV2lX9ukNM5QXloA",le="lVqlPjQLuQhK2flsxB78",te="O_EguRjsZ4uI1hHamkOA",se="jcaQQxoVnuuhtVwDJU1R",re="x-album-releasesDropdown",oe="in4OjUTflcsoj9RUpf05",ce="xaPiqLlyzjAbzAaXfU1y",de="vveb4Rn0dK_r8YUM7L_n",me=n.memo((function({uri:e,togglePlay:a,isPlaying:i,isActive:l,spec:t,logger:s,backgroundColor:r,name:o,artists:c,isPlayable:d,sharingInfo:m}){const u=(0,X.o)(),g=(0,$.k)(),b=(0,_.y)(),p=(0,n.useMemo)((()=>t.actionBarFactory()),[t]),[x,v]=(0,_.Z)(e),y=(0,n.useCallback)((()=>{const n=(0,J.aK)({isPlaying:i,isActive:l,spec:p.playButtonFactory(),logger:s,uri:e});a({loggingParams:n})}),[i,l,a,p,s,e]),j=(0,n.useCallback)((async()=>{let a;const i=p.saveButtonFactory();a=x?i.hitDislike({itemToBeDisliked:e}):i.hitLike({itemToBeLiked:e}),s.logInteraction(a),u({targetUri:e,intent:x?"unsave":"save",type:"click"});try{await v(!x)}catch{}}),[u,e,x,v,p,s]),N=(0,ae.Q)(),S=(0,K.j)();return(0,A.jsx)(Q.o,{backgroundColor:r,children:(0,A.jsxs)(Q.F,{children:[(0,A.jsx)(f.$,{onClick:y,disabled:!d,isPlaying:i,size:S,uri:e}),N&&(0,A.jsx)(B.Nh,{spec:p,children:(0,A.jsx)(ee.K,{entityName:o,contextUri:e,activationPlacement:"bottomEnd",size:S})}),(0,A.jsx)(W.x,{uri:e,action:G.sr.SAVE_ALBUM,children:(0,A.jsx)(Y.H,{isAdded:!!x,onClick:j,disabled:!g&&!b?.getCapabilities().canModifyOffline,size:S})}),(0,A.jsx)(Z.o,{uri:e,isFollowing:!!x,onClick:(a,i)=>(0,J.l7)(i,p.downloadButtonFactory(),s,e),onFollow:j,size:S}),(0,A.jsx)(P.yj,{onShow:()=>(0,J.qq)(p,s),menu:(0,A.jsx)(k.Y,{uri:e,artistUri:c?.[0]?.uri,sharingInfo:m}),children:(0,A.jsx)(H.z,{label:h.ag.get("more.label.context",o),size:S})}),(0,A.jsx)("div",{className:de,children:(0,A.jsx)(D.F,{property:q.FM,renderNewExperience:()=>(0,A.jsx)(z.A,{options:[],onSelect:()=>{},selected:null,enableViewModeMenu:!0})})})]})})}));var ue=i(36767);const ge=864e5,he=365.25*ge;var be=i(78344),ke=i(76841),pe=i(30485),xe=i(64518),ve=i(3839),ye=i(37959),je=i(73196);var fe=i(72162),Ne=i(81037),Se=i(55147),Ie=i(47200),we=i(10732),Ae=i(27816),Ce=i(38914),Le=i(82298),Ue=i(53885);var Fe=i(79709),Pe=i(3557),Me=i(58994),Te=i(98119),Re=i(20704);const Ee="TCmZzqInstJMZjkHgnw3",Be="PeNI572tTpqsN23o3QhJ",Ve="oUsSfFiifMPXqW0kHjR6",Oe="XKvEMQZlPfPncTqiitM5",De="GdbPVlmUCW0Q6ZZ0z0wh",ze="Hu7O5y7x5c7wUYFbnIoS",_e=n.memo((function(e){const{images:a,title:i,isOpen:l,onClose:t}=e,s=(0,n.useMemo)((()=>(0,Re.X)(a,{desiredSize:1e4})),[a]);return s?(0,A.jsx)(Me.Z,{className:Ee,isOpen:l,onRequestClose:t,animation:{modal:{base:Oe,afterOpen:De,beforeClose:ze}},animated:!0,children:(0,A.jsxs)("div",{style:{"--image-width":`${s.width}px`,"--image-height":`${s.height}px`},className:Be,children:[(0,A.jsx)(Te.E,{loading:"eager",alt:i,src:s.url,className:Ve}),(0,A.jsx)(Pe.o,{onClick:t,semanticColor:"textBase",children:h.ag.get("web-player.cover-art-modal.close")})]})}):null}));var qe=i(94467),Qe=i(19315);const Ye=({releases:e})=>(0,A.jsx)(qe.v,{children:e.map((e=>(0,A.jsx)(Qe.s,{role:"menuitem",to:(0,Se.EC)(e.uri).toURLPath(!0),children:e.name},e.uri)))});var Ze=i(35691),He=i(80414),We=i(3635);const Ke=n.lazy((()=>i.e(2214).then(i.bind(i,92214))));function Xe(e){switch(e){case He.V.Single:return h.ag.get("single");case He.V.Ep:return h.ag.get("ep");case He.V.Compilation:return h.ag.get("compilation");case He.V.Audiobook:return h.ag.get("card.tag.audiobook");case He.V.Album:default:return h.ag.get("album")}}const $e=({uri:e,album:a})=>{const i=(0,o.TH)(),{spec:l,logger:j,UBIFragment:N}=(0,B.fU)(g.w,{data:{uri:e}}),S=(0,n.useMemo)((()=>l.trackListFactory()),[l]),I=(0,n.useMemo)((()=>l.moreByArtistShelfFactory()),[l]),w=a.moreAlbumsByArtist,T=parseInt(new URLSearchParams((0,o.TH)().search).get("index")||"0",10),D=(0,U.Y)(e),{usePlayContextItem:z,togglePlay:_,isPlaying:q,isActive:Q}=(0,R.n)({uri:D},{featureIdentifier:"album"}),Y=(0,n.useCallback)(((e,a)=>{if(l){const e=l.headerFactory().artistNameFactory().hitUiNavigate({destination:a.creator.uri});j.logInteraction(e)}}),[j,l]),{isOpen:Z,openModal:H,closeModal:W}=(()=>{const[e,a]=(0,n.useState)(!1);return{isOpen:e,openModal:(0,n.useCallback)((()=>a(!0)),[]),closeModal:(0,n.useCallback)((()=>a(!1)),[])}})(),K=(0,u.W6)(je.DUY,{loadingValue:!1})?{onClick:H,ariaLabel:h.ag.get("web-player.album.open_coverart_modal")}:{},X=(0,n.useCallback)((()=>new URLSearchParams(i.search.slice(1)).get("highlight")||""),[i.search]),$=a.uri,J=a.name,G=a.albumType,ee=a.release?.date,ae=a.release?.precision,de=a.nrTracks,Pe=a.images,Me=a.extractedColors?.colorRaw.hex,Te=a.artists,Re=a.isPlayable,Ee=a.isCatalogueRestricted,Be=a.copyright.items,Ve=a.courtesyLine,Oe=a.duration.durationMs,De=a.duration.isEstimate,ze=X(),qe=(0,r.v9)(Ue.Gg),Qe=qe.overrides?.locale??h.ag.getLocaleForTranslation(),Ze=(0,Fe.k)({uri:e,type:"locale"}),He=(0,E.OT)({albumName:J,albumType:G,albumArtists:Te.map((e=>e.name)).join(h.ag.getSeparator()),shouldLocalize:Ze,i18n:h.ag});(0,F.Y5)(Me||null);const{albumILRAboveEnabled:$e,albumILRBelowEnabled:Je}=(()=>{const e=(0,ye.E)(),a=(0,o.TH)(),i=(0,u.W6)(je.t2x),n=(0,xe.vI)(ve.k.ILRAlbumAbove,a),l=(0,xe.vI)(ve.k.ILRAlbumBelow,a);return e?{albumILRAboveEnabled:!l&&(n||i===je.wPk.ABOVE),albumILRBelowEnabled:!n&&(l||i===je.wPk.BELOW)}:{albumILRAboveEnabled:!1,albumILRBelowEnabled:!1}})(),Ge=function(e){return(0,n.useMemo)((()=>{if(!e?.date)return null;if("day"===e.precision){const a=new Date(e.date),i=(new Date).getTime()-a.getTime(),n=i%he;return n<3.5*ge||n>312552e5?Math.round(i/he):null}return null}),[e])}(a.release),{isCompactMode:ea}=(0,L.mJ)(),aa=(e=>{const a=(0,we.g)(),i=(0,Ae.s4)(),l=(0,u.W6)(je.t2x),t=(0,r.v9)(Ue.n5),s=(0,r.v9)(Le.rZ);return(0,n.useCallback)((async()=>{if(!(0,Se.YF)(e))return;const n={category:"album_ilr_component_visible",action:"viewed",variant:l,label:"dwp",os:(0,Ce.y)(),context:e,country:t?s:"",sp_t:(0,Ie.vQ)("sp_t")};a?i.send((0,Ne.k)(n)):i.send((0,fe.x)(n))}),[e,s,i,a,t,l])})(e),{ref:ia,inView:na}=(0,s.YD)({threshold:0});return(0,n.useEffect)((()=>{na&&aa()}),[na,aa]),(0,A.jsxs)("section",{className:ie,"data-testid":"album-page",children:[(0,A.jsx)(p.$,{children:He}),null!==Ge?(0,A.jsx)(n.Suspense,{fallback:null,children:(0,A.jsx)(Ke,{colorLight:a?.extractedColors?.colorLight.hex,colorDark:a?.extractedColors?.colorDark.hex,name:J,years:Ge})}):null,(0,A.jsxs)(x.gF,{backgroundColor:Me,children:[(0,A.jsxs)(v.W,{children:[(0,A.jsx)(f.$,{size:"medium",onClick:()=>_(),disabled:!Re,isPlaying:q,uri:e}),(0,A.jsx)(y.i,{text:J,dragUri:e,dragLabel:J})]}),(0,A.jsx)(P._P,{menu:(0,A.jsx)(k.Y,{uri:a.uri,artistUri:Te?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,A.jsx)(x.Oz,{dragUri:$,images:Pe,name:J,placeholderType:"album",...K})}),(0,A.jsxs)(x.sP,{children:[(0,A.jsx)(be.g,{children:Xe(G)}),(0,A.jsx)(P._P,{menu:(0,A.jsx)(k.Y,{uri:a.uri,artistUri:Te?.[0]?.uri,sharingInfo:a.sharingInfo}),children:(0,A.jsx)(x.xd,{dragUri:a.uri,dragLabel:a.name,scaleAtMinWidth:x.vz,children:J})}),(0,A.jsx)(x.QS,{creators:Te,onCreatorClick:Y,releaseDate:ee,releaseDatePrecision:ae,totalItems:de,durationMilliseconds:Oe,isEstimatedDuration:De,hasTracks:!0})]})]}),(0,A.jsx)(me,{backgroundColor:Me,uri:e,togglePlay:_,isPlaying:q,isActive:Q,spec:l,logger:j,sharingInfo:a.sharingInfo,name:a.name,artists:a.artists,isPlayable:a.isPlayable}),Ee?(0,A.jsxs)("div",{className:ne,children:[(0,A.jsx)(c.x,{as:"h2",variant:"bodyMediumBold",className:le,children:h.ag.get("windowed.product-album-header")}),(0,A.jsx)("div",{className:te,children:h.ag.get("windowed.product-album-description")})]}):null,(0,A.jsxs)("div",{className:"contentSpacing",children:[(0,A.jsx)(N,{spec:S,children:(0,A.jsx)(ue.L,{ariaLabel:J,nrTracks:(0,We.y)(a.discs)?a.discs.totalCount+de:de,discs:a.discs,albumUri:$,highlightUri:ze,scrollToIndex:T,usePlayContextItem:z,initalTracks:a.items,isCompactMode:ea})}),(0,A.jsxs)("div",{className:oe,children:[(0,A.jsxs)("div",{children:[ee&&(0,A.jsx)(c.x,{as:"p",variant:"bodySmall",children:(0,O.BI)((0,O.RX)(ee),Qe,{year:"numeric",month:"long",day:"numeric"},ae)}),(0,A.jsx)(M.k,{copyrights:Be,courtesyLine:Ve})]}),a.releases.items.length>0&&(0,A.jsx)(P.xV,{menu:(0,A.jsx)(Ye,{releases:a.releases.items}),children:(e,i,n)=>(0,A.jsxs)("button",{ref:n,className:re,type:"button",onClick:i,children:[(0,A.jsx)(c.x,{variant:"bodySmall",children:h.ag.get("album-page.more-releases",a.releases.items.length)}),e?(0,A.jsx)(d.U,{size:"small"}):(0,A.jsx)(m.i,{size:"small"})]})})]})]}),$e&&(0,A.jsx)("div",{className:t()("contentSpacing",ce),"data-testid":"placeholder-album-ilr-above",children:(0,A.jsx)(ke.y,{subtitle:h.ag.get("internal-link-recommender.based-on-this-album"),uri:a.uri,inViewRef:ia,entityType:V.p.ALBUM})}),(0,A.jsx)(C,{albumName:J,albumURI:$}),(0,A.jsxs)(A.Fragment,{children:[w?.length>0&&(0,A.jsx)("div",{className:"contentSpacing",children:(0,A.jsx)(N,{spec:I,children:(0,A.jsx)(pe.q,{index:0,id:"more-albums",className:se,title:h.ag.get("album-page.more-by-artist",Te?.[0]?.name),total:w.length,seeAllUri:`${Te?.[0]?.uri.replace("artist","app:artist")}:discography`,seeAllLabel:h.ag.get("artist-page.show-discography"),alwaysShowSeeAll:!0,children:w.map(((e,a)=>(0,A.jsx)(b.i,{index:a,artists:Te,images:e.images||[],name:e.name,uri:e.uri,year:e.year,type:e.albumType,sharingInfo:e.sharingInfo},e.uri)))})})}),Je&&(0,A.jsx)("div",{className:t()("contentSpacing",ce),"data-testid":"placeholder-album-ilr-below",children:(0,A.jsx)(ke.y,{subtitle:h.ag.get("internal-link-recommender.based-on-this-album"),uri:a.uri,inViewRef:ia,entityType:V.p.ALBUM})})]}),(0,A.jsx)(_e,{title:He,isOpen:Z,onClose:W,images:Pe})]})},Je=n.memo((function(){const{albumId:e}=(0,o.UO)(),a=`spotify:album:${e}`,{loading:i,error:n,data:l,canLoadOffline:t}=(0,Ze.j)(a);return i||!l?(0,A.jsx)(j.h,{hasError:null!==n,loadOffline:t,errorMessage:h.ag.get("error.not_found.title.album")}):(0,A.jsx)(T.fd,{surface:T.Tg.ALBUM,uris:[a],children:(0,A.jsx)($e,{uri:a,album:l})})}))},64518:(e,a,i)=>{i.d(a,{vI:()=>n});i(38910);const n=(e,a)=>{const i=a?new URLSearchParams(a.search):void 0;return"1"===i?.get(e)}},3839:(e,a,i)=>{i.d(a,{k:()=>n});let n=function(e){return e.I18nSEO="i18nSEO",e.RTPTrackCredits="rtpv2p2",e.I18nAdditionalPages="i18nap",e.RichPlaylistPages="rpp",e.ILRAlbum="ilra",e.ILRAlbumAbove="ilraa",e.ILRAlbumBelow="ilrab",e.ILRShow="ilrs",e}({})}}]);
//# sourceMappingURL=xpui-routes-album.js.map